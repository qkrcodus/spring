비즈니스 로직을 jpa 와 entity로 풀어가는 방법을 알아갈 것이다.
도메인 모델 패턴 : entity 비즈니스 로직이 있고 더 많은 것을 위임
- 상품 주문
- 주문 내역
- 주문 취소
#### 개발 순서
- 주문 엔티티, 주문 상품 엔티티 개발
- 주문 리포지토리
- 주문 서비스
- 주문 검색 기능 개발
- 주문 테스트
---
#### 복습하고 가기
- DDD ( 도메인 주도 설계 )에선 엔티티 자체가 단순 데이터 저장소가 아니라, 엔티티 내부 데이터와 관련된 비즈니스 로직을 포함하게 설계한다.
- 즉, 객체의 상태를 관리하는 책임을 객체 스스로 갖게 하는 것이다. ( 캡슐화 강화 )
- service 계층에선 레포지토리 계층(Repository Layer)과의 상호작용을 구현한다.
- domain 계층에선 엔티티 매핑, 자신의 엔티티 관리, 연관관계 편의 메소드, 엔티티끼리의 비즈니스 로직을 구현한다.

따라서 item 엔티티 속에 addStock removeStock을 구현해둔 것이다.
![](https://i.imgur.com/UpASMPn.png)

연관관계 편의 메소드는 엔티티간 관계를 설정할 때 발생할 수 있는 실수를 줄이기 위함이다. 

ex ) 바퀴 - 자동차 
연관관계 편의 메서드는 애플리케이션 로직을 개발하면서 보통 좀 더 주도적인 곳에 만들어둔다. 연관 관계의 주인인 바퀴가 아니라 어플리케이션 로직이 자동차 중심으로 동작하기에 자동차에 연관 관계 메소드를 적는다. [ 2.도메인 분석 설계]

---
### 주문, 주문상품 엔티티 개발
#### Order
![](https://i.imgur.com/3OHG6ij.png)

#### OrderItem 
![](https://i.imgur.com/g0PSns1.png)



#### 주문 엔티티 잘 이해가 안된다. 엔티티에 구현해줘야하는 게 무엇인지 명확하게 감이 안 잡힌다.
주문 엔티티는 member_id 와 delivery_id를 외래키로 등록하여 Member 와 Delivery 엔티티와 연결된다.
Member 와 Delivery 엔티티간 비즈니스 로직을 구현하고 setMember( ), setDelivery( )
자신의 엔티티를 관리하고 createOrder( )
addOrderItem( )

![](https://i.imgur.com/Ssg7dMb.png)

---
### 주문 리포지토리 개발
#### Order repository
주문상태로 검색, 회원명으로 검색하는 건 복잡하니 추후에 만들기로 한다.
![](https://i.imgur.com/RHioOJE.png)

---
