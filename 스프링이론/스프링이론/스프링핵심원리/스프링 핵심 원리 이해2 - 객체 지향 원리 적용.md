기존의 할인 정책은 vip 면 1000원 할인
근데
10% 할인 되게 할인 정책을 바꾸고 싶다

![](https://i.imgur.com/0Si2hiF.png)

### RateDiscountPolicy 구현체와 테스트를 추가하자

[ 단축키 ]
- 테스트 작성 command shift t
- assertions static import  option enter
  
- RateDiscountPolicy 
![](https://i.imgur.com/AoW5CRO.png)

- RateDiscountPolicyTest
![](https://i.imgur.com/6Jguz0v.png)

---
### OrderServiceImpl 을 수정하여 RateDiscountPolicy를 적용해보자

![](https://i.imgur.com/esI7Arj.png)

하지만, 이는 DIP( OrderServiceImpl이 추상화 - 인터페이스 에도 의존하고, 구체화 - 구현체 (FixDiscountPolicy,RateDiscountPolicy)에도 의존하므로) 원칙을 위반하고

OCP ( 변경엔 열려있지만 수정엔 닫혀 있지 않으므로 ) 원칙도 위반한다

![](https://i.imgur.com/kzINPn7.png)

### 변경해보자

![](https://i.imgur.com/mLRi1iW.png)

인터페이스에만 의존하게 수정하면 createOrder 메소드에서 빈 객체에 . 으로 접근하니 NPE 발생

---
### 수정해보자
